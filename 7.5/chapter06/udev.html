<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      6.60.&nbsp;Udev-208 (Extracted from systemd-208)
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
    <link rel="stylesheet" href="stylesheets/lfs-print.css" type="text/css"
    media="print" />
  </head>
  <body class="lfs" id="lfs-7.5">
    <div class="navheader">
      <h4>
        Linux From Scratch - 版本 7.5
      </h4>
      <h3>
        第&nbsp;6&nbsp;章&nbsp;安装基本系统软件
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="texinfo.html" title="Texinfo-5.2">上一页</a>
          <p>
            Texinfo-5.2
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="util-linux.html" title=
          "Util-linux-2.24.1">下一页</a>
          <p>
            Util-linux-2.24.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "第&nbsp;6&nbsp;章&nbsp;安装基本系统软件">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 7.5">起始页</a>
        </li>
      </ul>
    </div>
    <div class="wrap" lang="zh-cn" xml:lang="zh-cn">
      <h1 class="sect1">
        <a id="ch-system-udev" name="ch-system-udev"></a>6.60. Udev-208
        (Extracted from systemd-208)
      </h1>
      <div class="package" lang="zh-cn" xml:lang="zh-cn">
        <p>
          The Udev package contains programs for dynamic creation of device
          nodes. The development of udev has been merged with systemd, but
          most of systemd is incompatible with LFS. Here we build and install
          just the needed udev files.
        </p>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">预计构建时间:</strong> <span class=
              "segbody">0.1 SBU</span>
            </div>
            <div class="seg">
              <strong class="segtitle">磁盘空间需求:</strong> <span class=
              "segbody">29 MB</span>
            </div>
          </div>
        </div>
      </div>
      <div class="installation" lang="zh-cn" xml:lang="zh-cn">
        <h2 class="sect2">
          6.60.1. Installation of Udev
        </h2>
        <div class="admon note">
          <img alt="[注意]" src="../images/note.png" />
          <h3>
            注意
          </h3>
          <p>
            This package is a little different from other packages. The
            initial package that is extracted is <code class=
            "filename">systemd-208.tar.xz</code> even though the application
            we are installing is udev. After changing to the systemd
            directory, follow the instructions below.
          </p>
        </div>
        <p>
          The udev-lfs tarball contains LFS-specific files used to build
          Udev. Unpack it into the systemd source directory:
        </p>
        <pre class="userinput">
<kbd class="command">tar -xvf ../udev-lfs-208-3.tar.bz2</kbd>
</pre>
        <p>
          Create two symbolic links to header files and set an environment
          variable to properly use <a class="xref" href=
          "../chapter05/util-linux.html" title=
          "5.33.&nbsp;Util-linux-2.24.1">第&nbsp;5.33&nbsp;节
          “Util-linux-2.24.1”</a>.
        </p>
        <pre class="userinput">
<kbd class="command">ln -svf /tools/include/blkid /usr/include
ln -svf /tools/include/uuid  /usr/include
export LD_LIBRARY_PATH=/tools/lib</kbd>
</pre>
        <p>
          Build the package:
        </p>
        <pre class="userinput">
<kbd class="command">make -f udev-lfs-208-3/Makefile.lfs</kbd>
</pre>
        <p>
          Install the package:
        </p>
        <pre class="userinput">
<kbd class="command">make -f udev-lfs-208-3/Makefile.lfs install</kbd>
</pre>
        <div class="admon caution">
          <img alt="[小心]" src="../images/caution.png" />
          <h3>
            小心
          </h3>
          <p>
            There are several places within the <span class=
            "application">systemd</span> source code that have explicit
            directory paths embedded. For instance, the binary version of the
            hardware database's path and file name used at run time,
            <code class="filename">/etc/udev/hwdb.bin</code>, cannot be
            changed without explicit changes to the source code.
          </p>
        </div>
        <p>
          Now initialize the hardware database:
        </p>
        <pre class="userinput">
<kbd class="command">build/udevadm hwdb --update</kbd>
</pre>
        <p>
          Finally set up the persistent network udev rules. This task will be
          explained in detail in <a class="xref" href=
          "../chapter07/network.html#stable-net-names" title=
          "7.2.1.&nbsp;Creating stable names for network interfaces">第&nbsp;7.2.1&nbsp;节
          “Creating stable names for network interfaces”</a>. Note that the
          <code class="filename">/sys</code> and <code class=
          "filename">/proc</code> filesystems must be mounted in the chroot
          environment as explained at the beginning of this chapter for the
          following script to work.
        </p>
        <pre class="userinput">
<kbd class="command">bash udev-lfs-208-3/init-net-rules.sh</kbd>
</pre>
        <p>
          Do some cleanup:
        </p>
        <pre class="userinput">
<kbd class="command">rm -fv /usr/include/{uuid,blkid}
unset LD_LIBRARY_PATH</kbd>
</pre>
      </div>
      <div class="content" lang="zh-cn" xml:lang="zh-cn">
        <h2 class="sect2">
          <a id="contents-udev" name="contents-udev"></a>6.60.2. Contents of
          Udev
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Installed programs:</strong>
              <span class="segbody">accelerometer, ata_id, cdrom_id, collect,
              mtd_probe, scsi_id, v4l_id, udevadm, and udevd</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed libraries:</strong>
              <span class="segbody">libudev.so</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Installed directories:</strong>
              <span class="segbody">/etc/udev, /lib/udev, /lib/firmware,
              /usr/share/doc/udev</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Short Descriptions
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="ata_id" name="ata_id"></a><span class=
                    "term"><span class=
                    "command"><strong>ata_id</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Provides Udev with a unique string and additional
                    information (uuid, label) for an ATA drive
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="cdrom_id" name="cdrom_id"></a><span class=
                    "term"><span class=
                    "command"><strong>cdrom_id</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Provides Udev with the capabilities of a CD-ROM or
                    DVD-ROM drive
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="collect" name="collect"></a><span class=
                    "term"><span class=
                    "command"><strong>collect</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Given an ID for the current uevent and a list of IDs (for
                    all target uevents), registers the current ID and
                    indicates whether all target IDs have been registered
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="scsi_id" name="scsi_id"></a><span class=
                    "term"><span class=
                    "command"><strong>scsi_id</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Provides Udev with a unique SCSI identifier based on the
                    data returned from sending a SCSI INQUIRY command to the
                    specified device
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="udevadm" name="udevadm"></a><span class=
                    "term"><span class=
                    "command"><strong>udevadm</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    Generic udev administration tool: controls the udevd
                    daemon, provides info from the Udev database, monitors
                    uevents, waits for uevents to finish, tests Udev
                    configuration, and triggers uevents for a given device
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="udevd" name="udevd"></a><span class=
                    "term"><span class=
                    "command"><strong>udevd</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    A daemon that listens for uevents on the netlink socket,
                    creates devices and runs the configured external programs
                    in response to these uevents
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libudev" name="libudev"></a><span class=
                    "term"><code class="filename">libudev</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    A library interface to udev device information
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="etc-udev" name="etc-udev"></a><span class=
                    "term"><code class="filename">/etc/udev</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    Contains Udev configuration files, device permissions,
                    and rules for device naming
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="texinfo.html" title="Texinfo-5.2">上一页</a>
          <p>
            Texinfo-5.2
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="util-linux.html" title=
          "Util-linux-2.24.1">下一页</a>
          <p>
            Util-linux-2.24.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "第&nbsp;6&nbsp;章&nbsp;安装基本系统软件">上一级</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - 版本 7.5">起始页</a>
        </li>
      </ul>
    </div>
  </body>
</html>
